## **Project3**：实现长度扩展攻击，以****SM3****为例

### 代码说明：

本项目实现了SM3的长度扩展攻击。长度扩展攻击即攻击者不知道原始消息a，知道H(a）和a的长度，通过长度扩展攻击，攻击者可以知道H(a+pad+附加消息)。

SM3的消息长度是64字节或者它的倍数，如果消息的长度不足则需要pad。SM3的填充规则：

![图片](https://github.com/puuuchiii/projects/blob/main/project%203/image/3.png)

### 本项目实现步骤：

<![if !supportLists]>（1）<![endif]>长度扩展攻击len_attack函数的参数m接收原始消息的hash，l接收原始消息的长度。任意构造长度为l的消息p，在此构造为l*‘a’（可构造为别的），得到p+填充+附加消息s。

（2）将SM3函数稍作改动，接收参数iv和参数t，参数t接收消息pad后的值。

（3）根据原始消息的hash值和pad(s)[1:]（附加消息pad值）计算c=SM3(m,pad(s)[1:])并返回c。

（4）直接通过初始iv算出原始消息+padding+附加消息的hash值，并与长度扩展攻击结果比较，若相同，攻击成功。

注意：可以更改原始消息即附加消息。

### 实现方式：

Python
